window.repositoryObject = {"columns_custom_fields":[],"relations_custom_fields":[],"unique_keys_custom_fields":[],"triggers_custom_fields":[],"columns":[{"id":"column-743","object_id":"column-743","name":"id","name_without_path":"id","description":"Record identification / auto increment","is_pk":true,"is_identity":true,"data_type":"int","data_length":"10, 0","is_nullable":false,"computed_formula":"","default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-744","object_id":"column-744","name":"type_id","name_without_path":"type_id","description":"References clevernt-cleverads-production.brands_accounts_deals_types table","is_pk":false,"is_identity":false,"data_type":"unsigned int","data_length":"10, 0","is_nullable":true,"computed_formula":"","default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[{"id":"t85","name":"brands_accounts_deals_types","name_show_schema":"brands_accounts_deals_types"}],"linked_lookup":null},{"id":"column-745","object_id":"column-745","name":"account_id","name_without_path":"account_id","description":"References clevernt-cleverads-production.brands_accounts table","is_pk":false,"is_identity":false,"data_type":"int","data_length":"10, 0","is_nullable":true,"computed_formula":"","default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[{"id":"t78","name":"brands_accounts","name_show_schema":"brands_accounts"}],"linked_lookup":null},{"id":"column-746","object_id":"column-746","name":"cpa_value","name_without_path":"cpa_value","description":"Cost per action value","is_pk":false,"is_identity":false,"data_type":"float","data_length":"12","is_nullable":true,"computed_formula":"","default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-747","object_id":"column-747","name":"revenue_value","name_without_path":"revenue_value","description":"Revenue share value","is_pk":false,"is_identity":false,"data_type":"float","data_length":"12","is_nullable":true,"computed_formula":"","default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-748","object_id":"column-748","name":"begin_date","name_without_path":"begin_date","description":"Begin date","is_pk":false,"is_identity":false,"data_type":"timestamp","data_length":null,"is_nullable":true,"computed_formula":"","default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-749","object_id":"column-749","name":"end_date","name_without_path":"end_date","description":"Ending date","is_pk":false,"is_identity":false,"data_type":"timestamp","data_length":null,"is_nullable":true,"computed_formula":"","default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-750","object_id":"column-750","name":"created_user_id","name_without_path":"created_user_id","description":"Created record user\r\nreferences clevernt-cleverads-production.users table","is_pk":false,"is_identity":false,"data_type":"int","data_length":"10, 0","is_nullable":false,"computed_formula":"","default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[{"id":"t251","name":"users","name_show_schema":"users"}],"linked_lookup":null},{"id":"column-751","object_id":"column-751","name":"updated_user_id","name_without_path":"updated_user_id","description":"Updated record user\r\nreferences clevernt-cleverads-production.users table","is_pk":false,"is_identity":false,"data_type":"int","data_length":"10, 0","is_nullable":true,"computed_formula":"","default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[{"id":"t251","name":"users","name_show_schema":"users"}],"linked_lookup":null},{"id":"column-752","object_id":"column-752","name":"deleted_user_id","name_without_path":"deleted_user_id","description":"Deleted record user\r\nreferences clevernt-cleverads-production.users table","is_pk":false,"is_identity":false,"data_type":"int","data_length":"10, 0","is_nullable":true,"computed_formula":"","default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[{"id":"t251","name":"users","name_show_schema":"users"}],"linked_lookup":null},{"id":"column-753","object_id":"column-753","name":"created_at","name_without_path":"created_at","description":"Date created record","is_pk":false,"is_identity":false,"data_type":"timestamp","data_length":null,"is_nullable":false,"computed_formula":"","default_value":"CURRENT_TIMESTAMP","path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-754","object_id":"column-754","name":"updated_at","name_without_path":"updated_at","description":"Date updated record","is_pk":false,"is_identity":false,"data_type":"timestamp","data_length":null,"is_nullable":true,"computed_formula":"","default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-755","object_id":"column-755","name":"deleted_at","name_without_path":"deleted_at","description":"Date deleted record","is_pk":false,"is_identity":false,"data_type":"timestamp","data_length":null,"is_nullable":false,"computed_formula":"","default_value":"0000-00-00 00:00:00","path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null}],"relations":[{"name":"FK_brands_accounts_deals_brands_accounts","title":null,"description":"cleverads.brands_accounts_deals(n) - cleverads.brands_accounts","is_user_defined":false,"foreign_table":"brands_accounts_deals","foreign_table_show_schema":"brands_accounts_deals","foreign_table_verbose":"brands_accounts_deals","foreign_table_verbose_show_schema":"brands_accounts_deals","foreign_table_object_id":"t83","primary_table":"brands_accounts","primary_table_show_schema":"brands_accounts","primary_table_verbose":"brands_accounts","primary_table_verbose_show_schema":"brands_accounts","primary_table_object_id":"t78","pk_cardinality":"1x","fk_cardinality":"mx","constraints":[{"primary_column_path":null,"primary_column":"id","foreign_column_path":null,"foreign_column":"account_id"}],"custom_fields":{}},{"name":"FK_brands_accounts_deals_types","title":null,"description":"cleverads.brands_accounts_deals(n) - cleverads.brands_accounts_deals_types","is_user_defined":false,"foreign_table":"brands_accounts_deals","foreign_table_show_schema":"brands_accounts_deals","foreign_table_verbose":"brands_accounts_deals","foreign_table_verbose_show_schema":"brands_accounts_deals","foreign_table_object_id":"t83","primary_table":"brands_accounts_deals_types","primary_table_show_schema":"brands_accounts_deals_types","primary_table_verbose":"brands_accounts_deals_types","primary_table_verbose_show_schema":"brands_accounts_deals_types","primary_table_object_id":"t85","pk_cardinality":"1x","fk_cardinality":"mx","constraints":[{"primary_column_path":null,"primary_column":"id","foreign_column_path":null,"foreign_column":"type_id"}],"custom_fields":{}},{"name":"FK_ brands_accounts_deals_users","title":null,"description":"cleverads.brands_accounts_deals(n) - cleverads.users","is_user_defined":false,"foreign_table":"brands_accounts_deals","foreign_table_show_schema":"brands_accounts_deals","foreign_table_verbose":"brands_accounts_deals","foreign_table_verbose_show_schema":"brands_accounts_deals","foreign_table_object_id":"t83","primary_table":"users","primary_table_show_schema":"users","primary_table_verbose":"users","primary_table_verbose_show_schema":"users","primary_table_object_id":"t251","pk_cardinality":"1x","fk_cardinality":"mx","constraints":[{"primary_column_path":null,"primary_column":"id","foreign_column_path":null,"foreign_column":"created_user_id"}],"custom_fields":{}},{"name":"FK_ brands_accounts_deals_users_2","title":null,"description":"cleverads.brands_accounts_deals(n) - cleverads.users","is_user_defined":false,"foreign_table":"brands_accounts_deals","foreign_table_show_schema":"brands_accounts_deals","foreign_table_verbose":"brands_accounts_deals","foreign_table_verbose_show_schema":"brands_accounts_deals","foreign_table_object_id":"t83","primary_table":"users","primary_table_show_schema":"users","primary_table_verbose":"users","primary_table_verbose_show_schema":"users","primary_table_object_id":"t251","pk_cardinality":"1x","fk_cardinality":"mx","constraints":[{"primary_column_path":null,"primary_column":"id","foreign_column_path":null,"foreign_column":"updated_user_id"}],"custom_fields":{}},{"name":"FK_ brands_accounts_deals_users_3","title":null,"description":"cleverads.brands_accounts_deals(n) - cleverads.users","is_user_defined":false,"foreign_table":"brands_accounts_deals","foreign_table_show_schema":"brands_accounts_deals","foreign_table_verbose":"brands_accounts_deals","foreign_table_verbose_show_schema":"brands_accounts_deals","foreign_table_object_id":"t83","primary_table":"users","primary_table_show_schema":"users","primary_table_verbose":"users","primary_table_verbose_show_schema":"users","primary_table_object_id":"t251","pk_cardinality":"1x","fk_cardinality":"mx","constraints":[{"primary_column_path":null,"primary_column":"id","foreign_column_path":null,"foreign_column":"deleted_user_id"}],"custom_fields":{}},{"name":"FK_brands_accounts_deals_brands_accounts_deals","title":null,"description":"cleverads.brands_accounts_deals_regions(n) - cleverads.brands_accounts_deals","is_user_defined":false,"foreign_table":"brands_accounts_deals_regions","foreign_table_show_schema":"brands_accounts_deals_regions","foreign_table_verbose":"brands_accounts_deals_regions","foreign_table_verbose_show_schema":"brands_accounts_deals_regions","foreign_table_object_id":"t84","primary_table":"brands_accounts_deals","primary_table_show_schema":"brands_accounts_deals","primary_table_verbose":"brands_accounts_deals","primary_table_verbose_show_schema":"brands_accounts_deals","primary_table_object_id":"t83","pk_cardinality":"1x","fk_cardinality":"mx","constraints":[{"primary_column_path":null,"primary_column":"id","foreign_column_path":null,"foreign_column":"deal_id"}],"custom_fields":{}}],"unique_keys":[{"name":"PRIMARY","description":"Primary key, contains columns: id","is_pk":true,"is_user_defined":false,"columns":[{"path":null,"name_without_path":"id","name":"id"}],"custom_fields":{}}],"triggers":[{"name":"brands_accounts_deals_after_insert","description":null,"action":"After Insert ","script":"BEGIN\r\n\r\nUPDATE c2c_prod.brands_accounts cba\r\nINNER JOIN \r\n(\r\nSELECT ba.bi_account,\r\n   truncate(bad.revenue_value,2)\t\t\t\t\t\t\t\t\tAS netrevenue,\r\n   bad.cpa_value\t\t\t\t\t\t\t\t\t\tAS cpa,\r\n  IF(badt.`name`='Revenue','trev',badt.`name`)\tAS deal\r\nFROM brands_accounts_deals bad\r\nINNER JOIN `brands_accounts` ba ON bad.account_id = ba.id\r\nLEFT JOIN brands_accounts_deals_types badt ON bad.type_id = badt.id\r\nWHERE bad.account_id= NEW.account_id AND bad.deleted_at='0000-00-00 00:00:00' \r\nORDER BY bad.begin_date DESC \r\nLIMIT 1\r\n-- AND CURDATE()>=bad.begin_date AND CURDATE()<=COALESCE(bad.end_date,CURDATE())\r\n) ba ON cba.bi_account = ba.bi_account COLLATE UTF8MB4_GENERAL_CI\r\nSET \r\ncba.deal = ba.deal,\r\ncba.netrevenue = ba.netrevenue,\r\ncba.cpa = ba.cpa;\r\n\r\nEND","custom_fields":{}},{"name":"brands_accounts_deals_after_update","description":null,"action":"After Update ","script":"BEGIN\r\n\r\nUPDATE c2c_prod.brands_accounts cba\r\nINNER JOIN \r\n(\r\nSELECT ba.bi_account,\r\n   truncate(bad.revenue_value,2)\t\t\t\t\t\t\t\t\t\tAS netrevenue,\r\n   bad.cpa_value\t\t\t\t\t\t\t\t\t\t\tAS cpa,\r\n  IF(badt.`name`='Revenue','trev',badt.`name`)\tAS deal\r\nFROM brands_accounts_deals bad\r\nINNER JOIN `brands_accounts` ba ON bad.account_id = ba.id\r\nLEFT JOIN brands_accounts_deals_types badt ON bad.type_id = badt.id\r\nWHERE bad.account_id= OLD.account_id AND bad.deleted_at='0000-00-00 00:00:00' \r\nORDER BY bad.begin_date DESC \r\nLIMIT 1\r\n-- AND CURDATE()>=bad.begin_date AND CURDATE()<=COALESCE(bad.end_date,CURDATE())\r\n) ba ON cba.bi_account = ba.bi_account COLLATE UTF8MB4_GENERAL_CI\r\nSET \r\ncba.deal = ba.deal,\r\ncba.netrevenue = ba.netrevenue,\r\ncba.cpa = ba.cpa;\r\n\r\nEND","custom_fields":{}}],"dependencies":{"uses":[{"object_name":"brands_accounts_deals","object_name_show_schema":"brands_accounts_deals","object_type":"TABLE","object_id":"t83","type":"NORMAL","object_user_defined":false,"user_defined":false,"children":[{"object_name":"brands_accounts","object_name_show_schema":"brands_accounts","object_type":"TABLE","object_id":"t78","type":"RELATION","pk_cardinality":"1x","fk_cardinality":"mx","object_user_defined":false,"user_defined":false,"children":[]},{"object_name":"brands_accounts_deals_types","object_name_show_schema":"brands_accounts_deals_types","object_type":"TABLE","object_id":"t85","type":"RELATION","pk_cardinality":"1x","fk_cardinality":"mx","object_user_defined":false,"user_defined":false,"children":[]},{"object_name":"users","object_name_show_schema":"users","object_type":"TABLE","object_id":"t251","type":"RELATION","pk_cardinality":"1x","fk_cardinality":"mx","object_user_defined":false,"user_defined":false,"children":[]},{"object_name":"users","object_name_show_schema":"users","object_type":"TABLE","object_id":"t251","type":"RELATION","pk_cardinality":"1x","fk_cardinality":"mx","object_user_defined":false,"user_defined":false,"children":[]},{"object_name":"users","object_name_show_schema":"users","object_type":"TABLE","object_id":"t251","type":"RELATION","pk_cardinality":"1x","fk_cardinality":"mx","object_user_defined":false,"user_defined":false,"children":[]}]},{"object_name":"brands_accounts_deals_after_insert","object_name_show_schema":"brands_accounts_deals_after_insert","object_type":"TRIGGER","type":"TRIGGER","object_user_defined":false,"user_defined":false,"children":[]},{"object_name":"brands_accounts_deals_after_update","object_name_show_schema":"brands_accounts_deals_after_update","object_type":"TRIGGER","type":"TRIGGER","object_user_defined":false,"user_defined":false,"children":[]}],"used_by":[{"object_name":"brands_accounts_deals","object_name_show_schema":"brands_accounts_deals","object_type":"TABLE","object_id":"t83","type":"NORMAL","object_user_defined":false,"user_defined":false,"children":[{"object_name":"brands_accounts_deals_regions","object_name_show_schema":"brands_accounts_deals_regions","object_type":"TABLE","object_id":"t84","type":"RELATION","pk_cardinality":"1x","fk_cardinality":"mx","object_user_defined":false,"user_defined":false,"children":[]}]}]},"object_id":"t83","name":"brands_accounts_deals","subtype":"TABLE","is_user_defined":false,"description":null,"summary":[{"field":"Documentation","value":{"_type":"link","name":"Cleverads","id":"d6"}},{"field":"Name","value":"brands_accounts_deals"},{"field":"Type","value":"Table"},{"field":"Linked areas","value":{"_type":"linked_areas","linked_areas":[{"id":"data_area19","name":"Brands&Accounts","type":"DATA_AREA","subtype":null}]}}],"script":null,"imported_at":"2024-06-28 17:00"};