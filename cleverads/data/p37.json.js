window.repositoryObject = {"parameters":[{"name":"$neria_id","description":null,"mode":"IN","data_type":"int(10, 0)","custom_fields":{},"linked_terms":[]}],"parameters_custom_fields":[],"dependencies":{"uses":[],"used_by":[]},"object_id":"p37","name":"v1_get_whitelist","subtype":"PROCEDURE","is_user_defined":false,"description":null,"summary":[{"field":"Documentation","value":{"_type":"link","name":"Cleverads","id":"d6"}},{"field":"Name","value":"v1_get_whitelist"},{"field":"Type","value":"Procedure"}],"script":"BEGIN\r\nSET $neria_id = IFNULL($neria_id,0);\r\n\r\nSELECT  d.name AS url\r\nFROM leads l\r\nINNER JOIN leads_domains ld ON ld.lead_id = l.id AND ld.deleted_at = '0000-00-00 00:00:00'\r\nINNER JOIN leads_domains_neria n ON n.lead_domain_id = ld.id AND n.deleted_at = '0000-00-00 00:00:00'\r\nINNER JOIN domains d ON d.id = ld.domain_id \r\n                        AND (d.blacklist_type_id IS NULL OR\r\n                             EXISTS(SELECT 1\r\n                                    FROM domains_blacklist_exceptions bk\r\n                                    WHERE  bk.domain_id = d.id\r\n                                    AND    bk.deleted_at = '0000-00-00 00:00:00'))\r\nWHERE l.status_id IN (2,8,14)\r\nAND n.neria  = $neria_id\r\nUNION\r\nSELECT d.name AS url\r\nFROM scripts_domains sd\r\nINNER JOIN scripts s ON sd.script_id = s.id\r\nINNER JOIN codes c ON s.code_id = c.id\r\nINNER JOIN leads l ON c.lead_id = l.id\r\nINNER JOIN domains d ON d.id = sd.domain_id \r\n                        AND (d.blacklist_type_id IS NULL OR\r\n                             EXISTS(SELECT 1\r\n                                    FROM domains_blacklist_exceptions bk\r\n                                    WHERE  bk.domain_id = d.id\r\n                                    AND    bk.deleted_at = '0000-00-00 00:00:00'))\r\nWHERE l.status_id IN (2,8,14) \r\nAND sd.deleted_at = '0000-00-00 00:00:00'  AND c.deleted_at = '0000-00-00 00:00:00' AND l.deleted_at = '0000-00-00 00:00:00'\r\nAND s.deleted_at = '0000-00-00 00:00:00' AND s.is_active = 1\r\nAND s.legacy_id  = $neria_id;\r\n \r\nEND","imported_at":"2024-06-28 17:00"};